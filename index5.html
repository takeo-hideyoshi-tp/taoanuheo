<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
     <script type='text/javascript' src="./dist/React.js"></script>
    <!--<script type='text/javascript' src="./test/react.js"></script>
    <script type='text/javascript' src="./test/react-dom.js"></script>-->
    <script src="test/babel.js"></script>
</head>

<body>
    <div id="test"></div>
    <div id="content"></div>
</body>
<script type="text/babel">
    var container = document.getElementById("test");
 
  class App extends React.Component{
      constructor(a,b){
         super(a, b)
         this.state = {
             x: "司徒正美"
         }
      }
      componentWillMount(){
          console.log("App componentWillMount")
      }
      componentDidMount(){
          console.log("App componentDidMount")
      }
      componentWillUpdate(){
          console.log("App componentWillUpdate")
      }
      componentDidUpdate(){
          console.log("App componentDidUpdate")
      }
      getChildContext(){
          return {
              child: 333
          }
      }
      render(){
          return <div>{this.state.x ? <p>
            <A ref={(a)=>{console.log("A",a)}} />
            <span ref={ (a)=>{console.log("span",a)} }>xxxx</span>
            </p>: "删除"}
            </div>
      }
  }
  class A extends React.Component{
      static contextTypes = {
          child: true
      }
      componentDidUpdate(){
          console.log("A componentDidUpdate")
      }
      componentDidMount(){
          console.log("A componentDidMount")
      }
      componentWillReceiveProps(p, c){
          console.log(p, c)
          console.log("A componentWillReceiveProps")
      }
    /*  shouldComponentUpdate(){
          console.log("A shouldComponentUpdate")
      }
      */
      componentWillUnmount(){
          console.log(this._reactInternalFiber.child.stateNode.innerHTML)
          console.log("A componentWillUnmount")
      }
      constructor(a,b){
         super(a, b)
         this.state = {
             x: "司徒正美"
         }
      }
      render(){
          return <strong ref={ (a)=>{console.log("strong",a)} }>{this.context.child}</strong>
      }
  }

   var b
   ReactDOM.render(<App />,container, function(){
       console.log(this, '执行ReactDOM.render回调')
       b = this
       console.log("准备setState")
       b.setState({
           x: 0
       }, function(){
          console.log(this, '执行setState回调')
       })
   });

</script>

</html>