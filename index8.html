<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
   <script type='text/javascript' src="./dist/React.js"></script>
   <!-- <script type='text/javascript' src="./test/react.js"></script>
    <script type='text/javascript' src="./test/react-dom.js"></script>-->
    <script type='text/javascript' src="./lib/babel.js"></script>
    <script type="text/babel">

      </script>
</head>

<body>

    <pre>应该等于
        render 333
        child render
        componentWillMount setState cb
        componentWillMount setState cb2
        ReactDOM cb
        will update
        render child
        child render
        did update
        child setState
        will update
        render eeee
        child render
        did update
        componentDidMount setState cb3
          
        </pre>
    <h1 id='example' class="root">

    </h1>
    <script type='text/babel'>
            var container = document.getElementById("example")
            var div = container;
          if(!window.ReactDOM){
            window. ReactDOM = React
          }
           // 
            var expect = function(a) {
                return {
                    toBe: function(b) {
                        console.log(a,"vs", b, a === b)
                    },
                    toEqual(b){
                        console.log(a,"vs", b, a +""=== b+"")
                    },
                }
            }  
            class Issue extends React.PureComponent {
            constructor(props) {
                super(props);
                this.state = {
                    status: "normal"
                };
            }

            componentWillUnmount() {
                console.log("执行componentWillUnmount")
                this.setState({ status: "unmount" });
            }

            render() {
                const { status } = this.state;

                if (status === "unmount") {
                    throw new Error("Issue unmounted");
                }

                return <span>Issue status: {status}</span>;
            }
        }

        class App extends React.PureComponent {
            constructor(props) {
                super(props);
                this.state = {
                    showIssue: true
                };
            }

            render() {
                const { showIssue } = this.state;
                console.log("render ", showIssue)
                return (
                    <div>
                        {showIssue && <Issue />}
                        <b>测试错误</b>
                    </div>
                );
            }
        }
        var s = ReactDOM.render(<App />, div);
   
        expect(div.getElementsByTagName("span").length).toBe(1);
        console.log("SET FLASE",s)
       s.setState({showIssue: false});
     
     //   expect(div.getElementsByTagName("span").length).toBe(0);
              
</script>


</html>