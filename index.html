<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>

  <script>
class SuffixNode {
    constructor(s) {
        this.children = [];
        this.value = s;
    }
    addSuffixNode(word){
      var add = true
      for(var i = 0; i < this.children.length; i++){
          var node = this.children[i]
          if(node.value[0] == word[0] && word[0] !== '#'){
            var pword = word
            for(var j = 0; j < word.length; j++){
              if(node.value[j] != word[j]){
                pword = word.slice(0, j) +'#'
                break
              }
            }
           
            if(word.length > node.value.length){
              console.log("***")
             
           
              var nextValue = word.slice( j) 

              var newNode = new SuffixNode(nextValue)
              node.children.push(newNode)
              mergeNode(node.children, nextValue.slice(0,-1))

              add = false
             // console.log("xxxx",nextValue)
              continue
            }else if(pword !== word){ //如果只是局部相等
              var cur = new SuffixNode(pword); //创建新节点
              var nextValue = node.value.slice(j);
              cur.children.push(new SuffixNode(word.slice(j)));//只一个子节点
              this.children[i] = cur; //反客为主
            }else{
              var cur = new SuffixNode(word); //创建新节点
              var nextValue = node.value.slice(word.length-1)
              this.children[i] = cur; //反客为主
            }
          
            node.value = nextValue
            cur.children.push(node)
            add = false
          }
        }
        if(add){
          this.children.push(new SuffixNode(word))
        }
    }
    
}
function mergeNode(nodes, value){
  
}
class SuffixTree {
    constructor() {
        this.root = new SuffixNode('');
        
    }
    insert(word) {
        word += '#'
        this.root.addSuffixNode(word)
        while(word){
          word = word.slice(1);
          
          if(word != '#'){
            this.root.addSuffixNode(word)
          }
          if(word == 'abcd#'){
            break
          }
        }
    }
}

var tree = new SuffixTree();
tree.insert("abcabxabcd");
//banana
// anana
//  nana
//   ana
//    na
//     a
//======
//abcabxabcd
// bcabxabcd
//  cabxabcd
//   abxabcd
//    bxabcd
//     xabcd
//      abcd
//       bcd
//        cd
//         d
console.log(tree);
            
 
    </script>
  <div id='root'></div>
</body>

</html>

